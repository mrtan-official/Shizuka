<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shizuka AI Assistant Pro | Abu Tanim</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #4ecdc4;
            --dark: #2d3436;
            --glass: rgba(255, 255, 255, 0.9);
        }

        * {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            padding: 10px;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            width: 100%; max-width: 500px;
            height: 90vh;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            display: flex; flex-direction: column;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            overflow: hidden; border: 1px solid rgba(255,255,255,0.3);
        }

        .header {
            background: white; padding: 20px;
            text-align: center; border-bottom: 1px solid #eee;
            position: relative;
        }

        .header h1 { font-size: 1.5rem; color: var(--dark); }
        .header p { font-size: 0.8rem; color: #666; }

        .chat-container {
            flex: 1; overflow-y: auto; padding: 20px;
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 15px; display: flex;
            flex-direction: column; animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } }

        .message-content {
            padding: 12px 18px; border-radius: 18px;
            max-width: 85%; font-size: 0.95rem; line-height: 1.4;
        }

        .user { align-items: flex-end; }
        .user .message-content {
            background: var(--primary); color: white;
            border-bottom-right-radius: 2px;
        }

        .assistant { align-items: flex-start; }
        .assistant .message-content {
            background: #f1f2f6; color: var(--dark);
            border-bottom-left-radius: 2px;
        }

        .app-grid {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 10px; padding: 15px; background: white;
            border-top: 1px solid #eee;
        }

        .app-icon {
            display: flex; flex-direction: column; align-items: center;
            font-size: 0.7rem; cursor: pointer; transition: 0.3s;
        }

        .app-icon i {
            width: 45px; height: 45px; background: #f8f9fa;
            border-radius: 12px; display: flex; align-items: center;
            justify-content: center; font-size: 1.2rem; margin-bottom: 5px;
        }

        .app-icon:hover i { background: var(--secondary); color: white; }

        .input-area {
            padding: 15px; background: white; display: flex; gap: 10px;
            align-items: center;
        }

        input {
            flex: 1; padding: 12px 20px; border: none;
            background: #f1f2f6; border-radius: 25px; outline: none;
        }

        .btn-round {
            width: 45px; height: 45px; border-radius: 50%;
            border: none; cursor: pointer; display: flex;
            align-items: center; justify-content: center;
            transition: 0.3s;
        }

        .btn-send { background: var(--primary); color: white; }
        .btn-mic { background: var(--secondary); color: white; }
        .btn-mic.listening { background: #ff4757; animation: pulse 1s infinite; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>âœ¨ Shizuka AI</h1>
        <p>Active Now | Created by Abu Tanim</p>
    </div>

    <div class="chat-container" id="chat">
        <div class="message assistant">
            <div class="message-content">
                Hello! I am Shizuka, your personal assistant. ðŸŒ¸ How can I help you today?
            </div>
        </div>
    </div>

    <div class="app-grid">
        <div class="app-icon" onclick="handleSystemCmd('whatsapp')">
            <i class="fab fa-whatsapp" style="color: #25D366;"></i>WhatsApp
        </div>
        <div class="app-icon" onclick="handleSystemCmd('facebook')">
            <i class="fab fa-facebook" style="color: #1877F2;"></i>Facebook
        </div>
        <div class="app-icon" onclick="handleSystemCmd('youtube')">
            <i class="fab fa-youtube" style="color: #FF0000;"></i>YouTube
        </div>
        <div class="app-icon" onclick="handleSystemCmd('camera')">
            <i class="fas fa-camera" style="color: #636e72;"></i>Camera
        </div>
    </div>

    <div class="input-area">
        <button class="btn-round btn-mic" id="mic" onclick="startVoice()"><i class="fas fa-microphone"></i></button>
        <input type="text" id="msgInput" placeholder="Ask Shizuka anything...">
        <button class="btn-round btn-send" onclick="sendMsg()"><i class="fas fa-paper-plane"></i></button>
    </div>
</div>

<script>
    const API_URL = 'https://shizuka-ai-assistant.onrender.com';
    const chat = document.getElementById('chat');
    const input = document.getElementById('msgInput');

    // System Commands Handling
    function handleSystemCmd(cmd) {
        addMsg(`Opening ${cmd}...`, true);
        
        switch(cmd) {
            case 'whatsapp': window.open('https://wa.me/', '_blank'); break;
            case 'facebook': window.open('https://facebook.com', '_blank'); break;
            case 'youtube': window.open('https://youtube.com', '_blank'); break;
            case 'camera': 
                if (navigator.mediaDevices) {
                    addMsg("Accessing camera...", false);
                    navigator.mediaDevices.getUserMedia({video: true}).then(s => s.getTracks().forEach(t => t.stop()));
                } break;
        }
        speak(`Opening ${cmd} for you.`);
    }

    async function sendMsg() {
        const text = input.value.trim();
        if(!text) return;

        const lowText = text.toLowerCase();

        // --- Custom Knowledge about Developer (Abu Tanim) ---
        if(lowText.includes("who is tanim") || lowText.includes("developer") || lowText.includes("creator") || lowText.includes("your owner")) {
            addMsg(text, true);
            const devBio = "My creator is Abu Tanim. He is a brilliant Software Developer from Chittagong. He completed his BSc in CSE from Premier University. His birthday is on September 20th. He loves Python coding! You can find his projects on GitHub: https://github.com/mrtan-official";
            addMsg(devBio, false);
            input.value = '';
            return;
        }

        // Smart App Commands
        if(lowText.includes("open whatsapp")) { handleSystemCmd('whatsapp'); input.value=''; return; }
        if(lowText.includes("open facebook")) { handleSystemCmd('facebook'); input.value=''; return; }
        if(lowText.includes("open camera")) { handleSystemCmd('camera'); input.value=''; return; }

        addMsg(text, true);
        input.value = '';

        try {
            const res = await fetch(`${API_URL}/api/query`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ query: text })
            });
            const data = await res.json();
            addMsg(data.text, false, data.data?.url ? API_URL + data.data.url : null);
        } catch(e) {
            addMsg("I'm having trouble connecting to my brain. Please check the server.", false);
        }
    }

    function addMsg(text, isUser, img = null) {
        const div = document.createElement('div');
        div.className = `message ${isUser ? 'user' : 'assistant'}`;
        div.innerHTML = `
            <div class="message-content">
                ${text}
                ${img ? `<img src="${img}" style="width:100%; border-radius:10px; margin-top:10px;">` : ''}
            </div>
        `;
        chat.appendChild(div);
        chat.scrollTop = chat.scrollHeight;
        if(!isUser) speak(text);
    }

    // --- Updated Lady Version Voice Function ---
    function speak(text) {
        const synth = window.speechSynthesis;
        const utter = new SpeechSynthesisUtterance(text);
        
        // Find a female voice
        const voices = synth.getVoices();
        const femaleVoice = voices.find(v => 
            v.name.includes('Google US English') || 
            v.name.includes('Female') || 
            v.name.includes('Zira') || 
            v.name.includes('Samantha') ||
            v.name.includes('Microsoft Maria')
        );

        if (femaleVoice) utter.voice = femaleVoice;
        
        utter.pitch = 1.3; // Cute Shizuka-like pitch
        utter.rate = 1.0; 
        synth.speak(utter);
    }

    // Pre-load voices for browser support
    window.speechSynthesis.onvoiceschanged = () => { window.speechSynthesis.getVoices(); };

    function startVoice() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.onstart = () => document.getElementById('mic').classList.add('listening');
        recognition.onend = () => document.getElementById('mic').classList.remove('listening');
        recognition.onresult = (e) => {
            input.value = e.results[0][0].transcript;
            sendMsg();
        };
        recognition.start();
    }

    input.addEventListener('keypress', (e) => e.key === 'Enter' && sendMsg());
</script>

</body>
</html>
